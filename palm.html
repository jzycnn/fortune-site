<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ç„å¸ˆ Â· æ‰‹ç›¸åˆ†æ</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body class="bg-paper">
  <header>
    <h1 class="logo">å¦™è¶£äººç”Ÿ</h1>
    <p class="slogan">ç„å¸ˆ Â· æ‰‹ç›¸åˆ†æ</p>
  </header>

  <main class="form-page">
    <div class="card">
      <h2>è¯·ä¸Šä¼ æ‚¨çš„æ‰‹æŒç…§ç‰‡</h2>
      <p>ç¡®ä¿æŒå¿ƒæ¸…æ™°ã€å…‰çº¿å……è¶³</p>
      <input type="file" id="palmUpload" accept="image/*" />
      <img id="preview" style="max-width:100%; margin-top:1rem; display:none; border-radius:8px;" />
      <button class="btn" onclick="submitPalm()" style="margin-top:1rem;">ğŸ” å¼€å§‹è§£æ</button>
      <div id="result" class="result"></div>
    </div>
  </main>

  <script>
    function previewImage(event) {
      const img = document.getElementById('preview');
      const file = event.target.files[0];
      if (file) {
        img.src = URL.createObjectURL(file);
        img.style.display = 'block';
      }
    }
    document.getElementById('palmUpload').addEventListener('change', previewImage);
  </script>

  <script type="module">
    import { callFortune } from './script.js';

    async function submitPalm() {
      const fileInput = document.getElementById('palmUpload');
      if (!fileInput.files.length) {
        alert("è¯·å…ˆä¸Šä¼ æ‰‹æŒç…§ç‰‡ï¼");
        return;
      }

      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = "ç„å¸ˆæ­£åœ¨è§‚çº¹...";

      try {
        // æ³¨æ„ï¼šå½“å‰ç‰ˆæœ¬ä¸å®é™…ä¸Šä¼ å›¾ç‰‡ï¼ˆä»…è§¦å‘ AI è§£è¯»ï¼‰
        // å¦‚éœ€çœŸå®å›¾åƒåˆ†æï¼Œéœ€åœ¨è¾¹ç¼˜å‡½æ•°ä¸­å¤„ç† Base64
        const { analysis } = await callFortune('palm', {});
        resultDiv.innerHTML = `<p>${analysis}</p>`;
      } catch (e) {
        resultDiv.innerHTML = `<p style="color:#c0392b;">${e.message}</p>`;
      }
    }
  </script>
</body>
</html>
